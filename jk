FROM n8nio/n8n:1.99.1

# Instalar dependencias necesarias para Puppeteer en Alpine
USER root
RUN apk add --no-cache \
  chromium \
  nss \
  freetype \
  harfbuzz \
  ttf-freefont \
  && mkdir -p /usr/lib/chromium/ \
  && ln -s /usr/bin/chromium-browser /usr/bin/chromium

ENV PUPPETEER_EXECUTABLE_PATH=/usr/bin/chromium-browser

EXPOSE 5678

# Railway detectará el puerto automáticamente si usas el $PORT
CMD ["n8n", "start", "--port", "$PORT"]
